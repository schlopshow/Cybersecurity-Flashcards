"What is NFS and what is its purpose?","Network File System (NFS) is a network file system developed by Sun Microsystems that allows accessing file systems over a network as if they were local. It's used between Linux and Unix systems and serves the same purpose as SMB but uses an entirely different protocol."
"What are the key differences between NFSv2, NFSv3, and NFSv4?","NFSv2 is older, supported by many systems, and operated entirely over UDP. NFSv3 has more features including variable file size and better error reporting but isn't fully compatible with NFSv2. NFSv4 includes Kerberos, works through firewalls, supports ACLs, is stateful, and only uses port 2049."
"What port does NFSv4 use and why is this significant?","NFSv4 uses only one UDP or TCP port 2049 to run the service, which simplifies the use of the protocol across firewalls compared to earlier versions."
"What protocol does NFS use and on which ports?","NFS is based on the Open Network Computing Remote Procedure Call (ONC-RPC/SUN-RPC) protocol exposed on TCP and UDP ports 111, which uses External Data Representation (XDR) for system-independent data exchange."
"How does NFS handle authentication and authorization?","NFS has no built-in authentication or authorization mechanism. Authentication is shifted to the RPC protocol's options, and authorization is derived from available file system information. The most common method is via UNIX UID/GID and group memberships."
"What file contains the NFS configuration and what does it do?","The /etc/exports file contains a table of physical filesystems on an NFS server accessible by clients. It specifies which folders are shared and what permissions clients have."
"What does the 'rw' option do in NFS exports?","The 'rw' option grants read and write permissions to the NFS share."
"What does the 'sync' option do in NFS exports?","The 'sync' option enables synchronous data transfer, which is slower but more reliable than asynchronous transfer."
"What does the 'root_squash' option do?","The 'root_squash' option assigns all permissions to files of root UID/GID 0 to the UID/GID of anonymous, which prevents root from accessing files on an NFS mount."
"What does the 'no_subtree_check' option do?","The 'no_subtree_check' option disables the checking of subdirectory trees in NFS shares."
"What are the dangerous NFS settings that should be avoided?","Dangerous settings include 'rw' (read/write access), 'insecure' (allows ports above 1024), 'nohide' (exports subdirectories), and 'no_root_squash' (keeps root privileges)."
"Why is the 'insecure' option dangerous?","The 'insecure' option is dangerous because it allows users to use ports above 1024. The first 1024 ports can only be used by root, so this option removes that security restriction."
"What ports are essential when footprinting NFS?","TCP ports 111 and 2049 are essential when footprinting NFS services."
"What command shows available NFS shares on a target?","The command 'showmount -e [target_ip]' shows the available NFS shares on a target system."
"How do you mount an NFS share?","Use the command 'sudo mount -t nfs [target_ip]:/ [local_directory]/ -o nolock' to mount an NFS share to a local directory."
"What Nmap scripts are useful for NFS enumeration?","The '--script nfs*' option with Nmap runs NFS-specific scripts that can show share contents, statistics, and mount information."
"How can you view file permissions and ownership on mounted NFS shares?","Use 'ls -l' to view files with usernames and group names, or 'ls -n' to view files with UIDs and GIDs."
"How do you unmount an NFS share?","Use the command 'sudo umount [local_directory]' to unmount the NFS share."
"What is the significance of UID/GID mappings in NFS?","NFS relies on UID/GID mappings for authorization, but the client and server don't need to have the same mappings, which can create security issues. This is why NFS should only be used in trusted networks."
"How can NFS be used for privilege escalation?","NFS can be used for privilege escalation by uploading a shell with SUID permissions of a specific user to the NFS share, then executing it via SSH to gain that user's privileges."
